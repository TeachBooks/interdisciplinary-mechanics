# Assignment 5

## Introduction
This assignment aims to apply the "wave-based" methods to solve some classical river and traffic flows problems. All required methodological backgrounds can be found in the slides of lectures 14, 15.


## Section 1: The "Fancy" race
We are going to organize a race between cars and water in a river. At time $t <0$, both flows are packed between $x = -200 \mathrm{m}$ and $x = 0 \mathrm{m}$ and hold by gates/traffic signals. We remove the gates and turn traffic signals into green at time $t = 0$. Let's see what is happening!

```{figure} ../figures/Assignment_5/A5_1.png
---
width: 100%
name: A5_Figure_1
align: center
---
Initial boundary conditions for the "fancy" race. (a) traffic flow (b) river flow.
```

{numref}`Figure {number} <A5_Figure_1>` represents the initial boundary conditions for both traffic (1a) and river (1b) flows. They define two Riemann problems at location $x = -200 \mathrm{m}$ and $x = 0 \mathrm{m}$. We are going to first focus on the front of the race, i.e., the Riemann problem at $x = 0 \mathrm{m}$. Our first objective is to draw the space-time diagram in both cases. {numref}`Figure {number} <A2_Figure_2` provides the fundamental diagram of the traffic flow.

```{figure} ../figures/Assignment_5/A5_2.png
---
width: 100%
name: A5_Figure_2
align: center
---
The traffic fundamental diagram providing the model parameters
```

## Question 1
The fundamental diagram in {numref}`Figure {number} <A2_Figure_2` is quadratic in free-flow and linear in congestion. The equations are

$$ 
\begin{align}
Q(\rho) &= a \rho^2 + b\rho \quad &&\text{in free-flow} \\
Q(\rho) &= w(\rho_{max} - \rho) \quad &&\text{in congestion}
\end{align}
$$ 

### Question 1a
````{admonition} Model answer
:class: dropdown

$w$ is the slope of the line in congestion modus.

$$ w = \frac{q_{max} - 0}{\rho_{max} - \rho_c} = \frac{0.6}{0.02 - 0.05} = 4 \mathrm{m/s}$$
````

### Question 1b

(Combine 2b and 2c)

````{admonition} Model answer
:class: dropdown
To find the value of $a$, 
$Q(\rho_c) = a \rho_c^2 + b\rho_c = q_{max}$
$a = \frac{q_{max} - v_{max}\rho_c}{\rho_c^2}= -20 \mathrm{m/s}$

To find the value of $b$, 
$Q'(0) = 2a \cdot 0 + b = v_{max}$
````

## Question 2
Draw the space-time diagram corresponding the Riemann problem at $x = 0 \mathrm{m}$ considering that the traffic obeys to the LWR model (first order macroscopic traffic flow model - cf. lecture 14). You will need it to answer the following questions.


````{admonition} Model Answer
:class: dropdown
You should have drawn a rarefaction wave to represent the front of the race (downstream $x=0$), otherwise double-check lecture 14.
````

Combine Q.2a and b
````{admonition} Model Answer
:class: dropdown
The speed is the slope of the $q$-$\rho$ diagram. Have a look at the first part.

The steepest part of the curve is when $\rho = 0$ and the most gentle part when $\rho = \rho_c$. The fastest kinematic wave speed is $13 \mathrm{m/s}$ ($v_{max}$).
The slowest kinematic wave speed is 
$Q'(\rho_c) = 2 a \rho_c + v_{max} = 11 \mathrm{m/s}$
````

Q.2b
The final space-time diagram.
````{admonition} Model Answer
:class: dropdown
Your space-time diagram should match the following:

```{figure} ../figures/Assignment_5/A5_3.png
---
width: 100%
name: A5_Figure_3
align: center
---
Space-Time Diagram for Traffic
```
````

## Question 3
Let's consider we have a referee waiting for the race at $x = 200 \mathrm{m}$ (she will wait for the water flow too later on!).


Q4a
````{admonition} Model Answer
:class: dropdown
The first car follows the fastest wave while the pack arrives right after the slowest wave. Front wave arrives at 

$$
t_1 = \frac{200 \mathrm{m}}{v_{max}} = 15.4 \mathrm{s}
$$
````

Q4b
````{admonition} Model Answer
:class: dropdown
The first car follows the fastest wave while the pack arrives right after the slowest wave. 

The main pack arrives at 
$$
t_2 = \frac{200}{11} = 18.2 \mathrm{s}
$$
````

## Question 4
Q5a

````{admonition} Model Answer
:class: dropdown
We look for the kinematic wave starting at $x = 0$ at $t = 0$ and reaching $x = 200$ at $t$. The slope of this kinematic wave is $Q'(\rho)$ but also $\frac{x}{t}$.

So, 

$$2a\rho + v_{max} = \frac{x}{t}$$

Hence, 

$$\rho = \frac{\frac{x}{t} - v_{max}}{2a}
````